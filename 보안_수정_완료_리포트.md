# λ³΄μ• μμ • μ™„λ£ λ¦¬ν¬νΈ

**μμ • μΌμ‹**: 2025-01-XX  
**ν”„λ΅μ νΈ**: muyi-giftcard  
**μƒνƒ**: β… λ³΄μ• λ¬Έμ  μμ • μ™„λ£

---

## π¨ λ°κ²¬λ λ³΄μ• λ¬Έμ 

### λ¬Έμ : JavaScript λ²λ“¤μ—μ„ API ν‚¤ λ…Έμ¶

**λ…Έμ¶λ ν‚¤**:
- `WIZZPAY_PASSWORD`
- `WIZZPAY_IV_KEY`
- `WIZZPAY_SALT`

**μ›μΈ**: `app/page.tsx`μ—μ„ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈκ°€ Wizzpay ν‚¤λ¥Ό μ§μ ‘ μ‚¬μ©

```typescript
// β μμ • μ „ (λ³΄μ• μ„ν—)
const wizzMid = process.env.NEXT_PUBLIC_WIZZPAY_MID;
const wizzIvKey = process.env.NEXT_PUBLIC_WIZZPAY_IV_KEY;
const wizzSalt = process.env.NEXT_PUBLIC_WIZZPAY_SALT;
const wizzPassword = process.env.NEXT_PUBLIC_WIZZPAY_PASSWORD;
```

---

## β… μμ • λ‚΄μ©

### 1. ν΄λΌμ΄μ–ΈνΈ μ½”λ“ μμ • (`app/page.tsx`)

**λ³€κ²½ μ‚¬ν•­**:
- β Wizzpay ν‚¤ μ§μ ‘ μ‚¬μ© μ κ±°
- β… `/api/payment/init` API νΈμ¶λ΅ λ³€κ²½
- β… μ„λ²„μ—μ„ μ•”νΈν™”λ λ°μ΄ν„°λ§ λ°›μ•„μ„ μ‚¬μ©

**μμ • ν›„ μ½”λ“**:
```typescript
// β… μμ • ν›„ (λ³΄μ• μ¤€μ)
const initResponse = await fetch(`${baseUrl}/api/payment/init`, {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    goodsname: productName,
    amt: amount.toString(),
    buyername: buyerName,
    bypassValue: bypassValue,
  }),
});

const initData = await initResponse.json();
// μ„λ²„μ—μ„ λ°›μ€ μ•”νΈν™”λ λ°μ΄ν„°λ§ μ‚¬μ©
const encryptedData = initData.data;
```

### 2. API κ°μ„  (`app/api/payment/init/route.ts`)

**μ¶”κ°€ μ‚¬ν•­**:
- β… `NOTIURL` μλ™ μ„¤μ •
- β… `RESULTURL` μλ™ μ„¤μ •
- β… Base URL μλ™ κ°μ§€

**μμ • λ‚΄μ©**:
```typescript
const paymentData = createPaymentData({
  // ... κΈ°μ΅΄ ν•„λ“
  resulturl: resulturl || `${baseUrl}/payment/return`,
  notiurl: notiurl || `${baseUrl}/api/payment/notification`,
});
```

### 3. λΌμ΄λΈλ¬λ¦¬ κ°μ„  (`lib/wizzpay.ts`)

**μ¶”κ°€ μ‚¬ν•­**:
- β… `resulturl` νλΌλ―Έν„° μ¶”κ°€
- β… `notiurl` νλΌλ―Έν„° μ¶”κ°€

---

## π“ μμ • μ „ν›„ λΉ„κµ

| ν•­λ© | μμ • μ „ | μμ • ν›„ |
|------|---------|---------|
| ν΄λΌμ΄μ–ΈνΈ ν‚¤ μ‚¬μ© | β μ§μ ‘ μ‚¬μ© | β… μ‚¬μ© μ• ν•¨ |
| μ•”νΈν™” μ„μΉ | β ν΄λΌμ΄μ–ΈνΈ | β… μ„λ²„ |
| ν‚¤ λ…Έμ¶ μ„ν— | β λ†’μ | β… μ—†μ |
| λ³΄μ• μ μ | 66.7% | μμƒ: 100% |

---

## π”„ μμ •λ ν”λ΅μ°

### μμ • μ „ (λ³΄μ• μ„ν—)
```
ν΄λΌμ΄μ–ΈνΈ
  β†“
Wizzpay ν‚¤ μ§μ ‘ μ‚¬μ© (NEXT_PUBLIC_*)
  β†“
ν΄λΌμ΄μ–ΈνΈμ—μ„ μ•”νΈν™”
  β†“
Wizzpay μ„λ²„
```

### μμ • ν›„ (λ³΄μ• μ¤€μ)
```
ν΄λΌμ΄μ–ΈνΈ
  β†“
POST /api/payment/init (μ„λ²„)
  β†“
μ„λ²„μ—μ„ μ•”νΈν™” (ν‚¤ λ…Έμ¶ μ—†μ)
  β†“
μ•”νΈν™”λ λ°μ΄ν„°λ§ ν΄λΌμ΄μ–ΈνΈλ΅ μ „μ†΅
  β†“
Wizzpay μ„λ²„
```

---

## β… λ‹¤μ λ‹¨κ³„

1. **μ¬λ°°ν¬ μ™„λ£** β…
2. **λ³΄μ• ν…μ¤νΈ μ¬μ‹¤ν–‰** β³
3. **ν†µν•© ν”λ΅μ° ν…μ¤νΈ** β³

---

**λ§μ§€λ§‰ μ—…λ°μ΄νΈ**: 2025-01-XX

