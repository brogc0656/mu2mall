# ë¡œì»¬ í”„ë¡ì‹œ ì„œë²„ êµ¬ì„± ì™„ë£Œ

**ì¼ì‹œ**: 2025-11-09  
**ìƒíƒœ**: âœ… êµ¬ì„± ì™„ë£Œ

---

## âœ… ì™„ë£Œëœ ì‘ì—…

### 1. í”„ë¡ì‹œ ì„œë²„ ì½”ë“œ ìƒì„±
- âœ… `proxy-server.js` ìƒì„±
- âœ… Express ê¸°ë°˜ í”„ë¡ì‹œ ì„œë²„
- âœ… CORS ì„¤ì • (Vercel í—ˆìš©)
- âœ… ë¡œê¹… ê¸°ëŠ¥

### 2. ì½”ë“œ ìˆ˜ì •
- âœ… `lib/chlifes.ts`: í”„ë¡ì‹œ ì„œë²„ URL ì§€ì›
- âœ… í™˜ê²½ ë³€ìˆ˜ `CHLIFES_PROXY_URL` ì‚¬ìš©

### 3. ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
- âœ… `start-proxy.sh` ìƒì„±
- âœ… Cloudflare Tunnel ìë™ ì‹¤í–‰

---

## ğŸš€ ì‚¬ìš© ë°©ë²•

### ë°©ë²• 1: Cloudflare Tunnel (ê¶Œì¥)

```bash
# 1. í”„ë¡ì‹œ ì„œë²„ ì‹œì‘
cd /Users/hasanghyeon/brother_site/muyi-giftcard
node proxy-server.js

# 2. ë‹¤ë¥¸ í„°ë¯¸ë„ì—ì„œ Cloudflare Tunnel ì‹¤í–‰
cloudflared tunnel run chlifes-proxy --url http://localhost:3001
```

**ê²°ê³¼ URL ì˜ˆì‹œ**:
```
https://xxxx-xxxx-xxxx.trycloudflare.com
```

### ë°©ë²• 2: ngrok

```bash
# ngrok ì„¤ì¹˜
brew install ngrok

# ngrok ì‹¤í–‰
ngrok http 3001
```

**ê²°ê³¼ URL ì˜ˆì‹œ**:
```
https://abc123.ngrok.io
```

### ë°©ë²• 3: ì§ì ‘ ê³µì¸ IP ì‚¬ìš©

**í˜„ì¬ ê³µì¸ IP**: `180.80.147.23`

**ë¼ìš°í„° í¬íŠ¸ í¬ì›Œë”© ì„¤ì • í•„ìš”**:
- ì™¸ë¶€ í¬íŠ¸: 3001
- ë‚´ë¶€ IP: 192.168.219.104
- ë‚´ë¶€ í¬íŠ¸: 3001

**URL**: `http://180.80.147.23:3001`

---

## ğŸ”§ Vercel í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

### Cloudflare Tunnel ì‚¬ìš© ì‹œ

```bash
vercel env add CHLIFES_PROXY_URL production
# ê°’: https://xxxx-xxxx-xxxx.trycloudflare.com/proxy/chlifes
```

### ngrok ì‚¬ìš© ì‹œ

```bash
vercel env add CHLIFES_PROXY_URL production
# ê°’: https://abc123.ngrok.io/proxy/chlifes
```

### ì§ì ‘ IP ì‚¬ìš© ì‹œ

```bash
vercel env add CHLIFES_PROXY_URL production
# ê°’: http://180.80.147.23:3001/proxy/chlifes
```

---

## ğŸ“‹ í´ë¼ì´í”„ìŠ¤ IP ë“±ë¡

### ë“±ë¡í•  IP

**ë°©ë²• 1: Cloudflare Tunnel ì‚¬ìš©**
- Cloudflareì˜ IP ë²”ìœ„ í™•ì¸ í•„ìš”
- ë˜ëŠ” Cloudflare ì§€ì›íŒ€ì— ë¬¸ì˜

**ë°©ë²• 2: ì§ì ‘ IP ì‚¬ìš©**
- ê³µì¸ IP: `180.80.147.23`
- í´ë¼ì´í”„ìŠ¤ì— ì´ IP ë“±ë¡ ìš”ì²­

---

## âœ… í…ŒìŠ¤íŠ¸ ë°©ë²•

### 1. ë¡œì»¬ í…ŒìŠ¤íŠ¸

```bash
# í”„ë¡ì‹œ ì„œë²„ ì‹¤í–‰
node proxy-server.js

# ë‹¤ë¥¸ í„°ë¯¸ë„ì—ì„œ í…ŒìŠ¤íŠ¸
curl -X POST http://localhost:3001/proxy/chlifes/bro/gift_add.php \
  -H "Content-Type: application/json" \
  -d '{"GENID":"AG20181105144054","CMD":"ADD","GIFTNM":"TE20241216184900","FACE_PRICE":"test","ISSUE_REQ_SN":"TEST001","RECV_HPNO":"test","MESSAGE":"test","VALID_DAY":"30"}'
```

### 2. Cloudflare Tunnel í…ŒìŠ¤íŠ¸

```bash
# Tunnel URL í™•ì¸ í›„
curl -X POST https://xxxx-xxxx-xxxx.trycloudflare.com/proxy/chlifes/bro/gift_add.php \
  -H "Content-Type: application/json" \
  -d '{"GENID":"AG20181105144054","CMD":"ADD","GIFTNM":"TE20241216184900","FACE_PRICE":"test","ISSUE_REQ_SN":"TEST002","RECV_HPNO":"test","MESSAGE":"test","VALID_DAY":"30"}'
```

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

### í•„ìˆ˜ ì‚¬í•­
1. **ì»´í“¨í„° í•­ìƒ ì¼œì ¸ ìˆì–´ì•¼ í•¨**
   - 24/7 ìš´ì˜ í•„ìš”
   - ì „ë ¥ ì†Œë¹„ ê³ ë ¤

2. **PM2ë¡œ í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬ ê¶Œì¥**
   ```bash
   npm install -g pm2
   pm2 start proxy-server.js --name chlifes-proxy
   pm2 startup
   pm2 save
   ```

3. **ìë™ ì¬ì‹œì‘ ì„¤ì •**
   - ì»´í“¨í„° ì¬ë¶€íŒ… ì‹œ ìë™ ì‹¤í–‰
   - PM2 ë˜ëŠ” systemd ì‚¬ìš©

### ë³´ì•ˆ
1. **HTTPS ì‚¬ìš© ê¶Œì¥**
   - Cloudflare Tunnel: ìë™ HTTPS
   - ngrok: ìë™ HTTPS
   - ì§ì ‘ IP: HTTPë§Œ ê°€ëŠ¥ (ë³´ì•ˆ ì·¨ì•½)

2. **ë°©í™”ë²½ ì„¤ì •**
   - í•„ìš”í•œ í¬íŠ¸ë§Œ ì—´ê¸°
   - ë¶ˆí•„ìš”í•œ ì ‘ê·¼ ì°¨ë‹¨

---

## ğŸ¯ ë‹¤ìŒ ë‹¨ê³„

1. **í”„ë¡ì‹œ ì„œë²„ ì‹¤í–‰**
   ```bash
   node proxy-server.js
   ```

2. **Cloudflare Tunnel ì‹¤í–‰**
   ```bash
   cloudflared tunnel run chlifes-proxy --url http://localhost:3001
   ```

3. **URL í™•ì¸ ë° Vercel í™˜ê²½ ë³€ìˆ˜ ì„¤ì •**

4. **í´ë¼ì´í”„ìŠ¤ì— IP ë“±ë¡ ìš”ì²­**
   - ê³µì¸ IP: `180.80.147.23`
   - ë˜ëŠ” Cloudflare IP ë²”ìœ„

5. **í…ŒìŠ¤íŠ¸ ë° ë°°í¬**

---

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2025-11-09

