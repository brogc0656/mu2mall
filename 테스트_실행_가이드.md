# 테스트 실행 가이드

**프로젝트**: muyi-giftcard  
**상태**: ⚠️ **테스트 파일 존재하나 최근 실행 기록 없음**

---

## 📋 현재 상태

### ✅ 확인 완료
- ✅ Playwright 설치됨 (버전 1.56.1)
- ✅ 테스트 파일 존재 (2개)
  - `tests/production-security-audit.spec.ts`
  - `tests/original-design-verification.spec.ts`
- ✅ 테스트 스크립트 추가 완료
- ✅ Playwright 설정 파일 생성 완료

### ⚠️ 확인 필요
- ⚠️ 최근 테스트 실행 기록 없음
- ⚠️ 과거 테스트 실패 기록 있음 (5개 실패)
- ⚠️ 실제 프로덕션 API 테스트 미실행

---

## 🧪 테스트 실행 방법

### 1. 프로덕션 보안 검수 테스트

```bash
cd /Users/hasanghyeon/brother_site/muyi-giftcard

# 테스트 목록 확인
npx playwright test tests/production-security-audit.spec.ts --list

# 전체 테스트 실행
npx playwright test tests/production-security-audit.spec.ts

# 헤디드 모드 (브라우저 보면서)
npx playwright test tests/production-security-audit.spec.ts --headed

# 특정 테스트만 실행
npx playwright test tests/production-security-audit.spec.ts -g "민감한 환경 변수"
```

**테스트 항목** (10개):
1. 민감한 환경 변수 노출 체크
2. JavaScript 번들에서 API 키 체크
3. NEXT_PUBLIC 환경 변수 확인
4. 네트워크 요청에서 민감 정보 전송 체크
5. HTTP 보안 헤더 확인
6. Console에서 민감 정보 로그 체크
7. XSS 방어 체크
8. API 엔드포인트 직접 접근 방어 체크
9. HTTPS 강제 확인
10. 종합 보안 점수

---

### 2. 원본 디자인 검증 테스트

```bash
# 로컬 서버 시작 필요
npm run dev

# 새 터미널에서
npx playwright test tests/original-design-verification.spec.ts
```

**테스트 항목**:
- 페이지 로드 및 기본 요소 확인
- 상품권 카드 표시 확인
- 금액 선택 및 UI 업데이트
- 구매 버튼 클릭 시 모달 오픈
- 모달 입력 필드 수정 가능
- FAQ 섹션 확인
- 반응형 디자인 확인

---

### 3. API 직접 테스트

#### 상품권 발급 API 테스트

```bash
# 프로덕션 환경 테스트
curl -X POST https://muyi-giftcard.vercel.app/api/giftcard \
  -H "Content-Type: application/json" \
  -d '{
    "orderId": "TEST-'$(date +%s)'",
    "phone": "01012345678",
    "amount": 10000,
    "message": "테스트 상품권"
  }'
```

**예상 응답**:
- 성공: `{"success": true, "data": {...}}`
- 실패: `{"error": "...", "retCode": "..."}`

---

## 📊 과거 테스트 결과 (2025-11-05)

### Playwright 자동화 테스트
```
Running 3 tests using 1 worker

✓ Complete payment and gift card issuance flow (2.3m)
✓ Test Wizzpay payment page standalone         (2.6s)
✓ Test Chlifes API page standalone             (6.3s)

3 passed (2.5m)
```

**자동화된 작업**:
- ✅ 브라우저 자동 실행
- ✅ 페이지 네비게이션
- ✅ 폼 자동 입력
- ✅ 버튼 자동 클릭
- ✅ 팝업 자동 감지
- ✅ 스크린샷 캡처 (11개)

---

## ⚠️ 현재 문제점

### 1. 테스트 파일과 실제 코드 불일치 가능성
- 규격서 준수 코드로 수정됨
- 테스트 파일이 구버전 코드 기준일 수 있음

### 2. 통합 플로우 테스트 파일 없음
- `tests/integration-flow.spec.ts` 파일 존재 여부 확인 필요
- 문서에는 언급되어 있으나 실제 파일 없을 수 있음

### 3. 프로덕션 환경 테스트 미실행
- 실제 API 호출 테스트 필요
- 규격서 준수 코드 테스트 필요

---

## ✅ 권장 조치

### 즉시 실행
1. **프로덕션 보안 검수 테스트 실행**
   ```bash
   npx playwright test tests/production-security-audit.spec.ts --headed
   ```

2. **API 직접 테스트**
   ```bash
   curl -X POST https://muyi-giftcard.vercel.app/api/giftcard ...
   ```

3. **테스트 결과 확인**
   ```bash
   npx playwright show-report
   ```

### 다음 단계
1. 테스트 파일 업데이트 (규격서 준수 코드에 맞게)
2. 통합 플로우 테스트 추가
3. CI/CD 통합 (GitHub Actions)

---

**마지막 업데이트**: 2025-01-XX

