# 환경 변수 설정 완료 리포트

**설정 일시**: 2025-01-XX  
**프로젝트**: muyi-giftcard  
**상태**: ✅ 대부분 완료 (Supabase 설정 필요)

---

## ✅ 설정 완료된 환경 변수

### 클라이프스 API (5개)
- ✅ `CHLIFES_GENID` = `AG20251006211422` (프로덕션)
- ✅ `CHLIFES_GIFTNM` = `PR20251006212653` (프로덕션)
- ✅ `CHLIFES_ENC_KEY` = `brcardealpasswords2PW3kaxheYY064` (프로덕션)
- ✅ `CHLIFES_IV` = `1234123412341234`
- ✅ `NEXT_PUBLIC_CHLIFES_URL` = `https://api.chlifes.co.kr` (프로덕션)

### Wizzpay (5개)
- ✅ `WIZZPAY_MID` = `isptest03m`
- ✅ `WIZZPAY_IV_KEY` = `7e74bfa70c4a79d827b500ab9a287d63`
- ✅ `WIZZPAY_SALT` = `f8eb4a8a6873ba15e86668f1a17c0642`
- ✅ `WIZZPAY_PASSWORD` = `1733`
- ✅ `NEXT_PUBLIC_WIZZPAY_URL` = `https://pgadmin.wizzpay.co.kr`

### 기타 (1개)
- ✅ `NEXT_PUBLIC_BASE_URL` = `https://muyi-giftcard.vercel.app` (프로덕션)

**총 11개 환경 변수 설정 완료**

---

## ⚠️ 설정 필요: Supabase (3개)

다음 Supabase 환경 변수들은 **실제 프로젝트 값**이 필요합니다:

### 필요한 환경 변수
1. `NEXT_PUBLIC_SUPABASE_URL`
   - Supabase 프로젝트 URL
   - 형식: `https://xxxxx.supabase.co`
   - 위치: Supabase 대시보드 → Settings → API → Project URL

2. `NEXT_PUBLIC_SUPABASE_ANON_KEY`
   - Supabase Anon (Public) Key
   - 위치: Supabase 대시보드 → Settings → API → Project API keys → `anon` `public`

3. `SUPABASE_SERVICE_ROLE_KEY`
   - Supabase Service Role Key (서버 전용)
   - 위치: Supabase 대시보드 → Settings → API → Project API keys → `service_role` `secret`
   - ⚠️ **절대 클라이언트에 노출하지 마세요!**

### 설정 방법

#### 방법 1: Vercel CLI 사용
```bash
cd muyi-giftcard

# Supabase URL 설정
echo "https://your-project.supabase.co" | vercel env add NEXT_PUBLIC_SUPABASE_URL production

# Anon Key 설정
echo "your_anon_key_here" | vercel env add NEXT_PUBLIC_SUPABASE_ANON_KEY production

# Service Role Key 설정
echo "your_service_role_key_here" | vercel env add SUPABASE_SERVICE_ROLE_KEY production
```

#### 방법 2: Vercel 대시보드 사용
1. https://vercel.com 접속
2. 프로젝트 `muyi-giftcard` 선택
3. Settings → Environment Variables
4. 위의 3개 환경 변수 추가

---

## 📋 환경 변수 확인

### 현재 설정된 모든 환경 변수 확인
```bash
cd muyi-giftcard
vercel env ls
```

### 특정 환경 변수 확인
```bash
vercel env pull .env.local  # 로컬로 다운로드 (비추천 - 보안 위험)
```

---

## 🔄 재배포 필요

환경 변수를 추가/수정한 후에는 **반드시 재배포**해야 합니다:

### 자동 재배포 (권장)
```bash
# GitHub에 푸시하면 자동 배포
git add .
git commit -m "환경 변수 설정 완료"
git push origin main
```

### 수동 재배포
```bash
vercel --prod
```

---

## ✅ 다음 단계

1. **Supabase 프로젝트 확인**
   - Supabase 대시보드 접속
   - 프로젝트 URL 및 API 키 확인
   - 환경 변수 설정

2. **Supabase 데이터베이스 설정**
   - `transactions` 테이블 생성 확인
   - 마이그레이션 파일 적용: `supabase/migrations/001_create_transactions_table.sql`
   - RLS 정책 확인

3. **재배포**
   - Supabase 환경 변수 설정 후 재배포
   - 배포 후 기능 테스트

4. **프로덕션 테스트**
   - 상품권 발급 테스트
   - 결제 플로우 테스트
   - 데이터베이스 저장 확인

---

## 🔒 보안 주의사항

### ✅ 올바른 설정
- 서버 전용 키는 `NEXT_PUBLIC_` 접두사 없이 설정
- 클라이언트 노출 가능한 URL만 `NEXT_PUBLIC_` 사용

### ❌ 잘못된 설정 (절대 하지 마세요!)
- `NEXT_PUBLIC_CHLIFES_GENID` ❌
- `NEXT_PUBLIC_CHLIFES_ENC_KEY` ❌
- `NEXT_PUBLIC_WIZZPAY_PASSWORD` ❌
- `NEXT_PUBLIC_SUPABASE_SERVICE_ROLE_KEY` ❌

---

## 📊 설정 상태 요약

| 카테고리 | 설정 완료 | 총 개수 | 완료율 |
|---------|----------|--------|--------|
| 클라이프스 API | 5 | 5 | 100% |
| Wizzpay | 5 | 5 | 100% |
| Supabase | 0 | 3 | 0% |
| 기타 | 1 | 1 | 100% |
| **전체** | **11** | **14** | **79%** |

---

## 🔗 관련 링크

- **Vercel 대시보드**: https://vercel.com/dashboard
- **Supabase 대시보드**: https://supabase.com/dashboard
- **프로젝트 배포 URL**: https://muyi-giftcard.vercel.app

---

**마지막 업데이트**: 2025-01-XX  
**설정 담당**: 시스템 자동 설정

