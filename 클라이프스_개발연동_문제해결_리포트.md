# ν΄λΌμ΄ν”„μ¤ κ°λ° μ—°λ™ λ¬Έμ  ν•΄κ²° λ¦¬ν¬νΈ

**μΌμ‹**: 2025-11-09  
**ν™κ²½**: κ°λ° (devapi.chlifes.co.kr)  
**κ²°κ³Ό**: β… **μ„±κ³µ**

---

## π” λ°κ²¬λ λ¬Έμ 

### 1. ISSUE_REQ_SN κΈΈμ΄ μ΄κ³Ό (μ—λ¬ μ½”λ“: 010110)

**λ¬Έμ **:
- μƒμ„±λ `ISSUE_REQ_SN`μ΄ **23μ**μ€μ
- κ·κ²©μ„: **20μ μ΄ν•** ν•„μ

**μ—λ¬ μ½”λ“**:
```
010110: ISSUE_REQ_SN κΈΈμ΄ μ΄κ³Ό
```

**μ›μΈ μ½”λ“**:
```javascript
// β μλ»λ μ½”λ“ (23μ μƒμ„±)
const timestamp = Date.now(); // 13μ
const random = Math.random().toString(36).substring(2, 8); // 6μ
return `BRO${timestamp}${random}`; // 3 + 13 + 6 = 22μ (μ‹¤μ λ΅λ” λ” κΈΈ μ μμ)
```

---

### 2. MESSAGE ν•„λ“ μ•”νΈν™” λ„λ½

**λ¬Έμ **:
- `MESSAGE` ν•„λ“λ¥Ό **ν‰λ¬Έ**μΌλ΅ μ „μ†΅
- κ·κ²©μ„ 2.2: **μ•”νΈν™” λ€μƒ**μΌλ΅ λ…μ‹

**κ·κ²©μ„ λ‚΄μ©**:
```
### 2.2 μ•”νΈν™” λ€μƒ ν•„λ“
λ‹¤μ ν•„λ“λ“¤μ€ μ•”νΈν™”ν•μ—¬ μ „μ†΅ν•΄μ•Ό ν•©λ‹λ‹¤:
- μ „ν™”λ²νΈ (RECV_HPNO)
- κΈμ•΅ (FACE_PRICE)
- λ©”μ‹μ§€ (MESSAGE)  β† λ…μ‹λ¨
```

---

## β… ν•΄κ²° λ°©λ²•

### 1. ISSUE_REQ_SN κΈΈμ΄ μμ •

**μμ •λ μ½”λ“** (`lib/utils.ts`):
```typescript
export function generateIssueReqSn(): string {
  const now = new Date();
  // YYYYMMDDHHmmss = 14μ
  const timestamp = now.toISOString()
    .replace(/[-:T.]/g, '')
    .slice(0, 14);
  // BRO(3) + timestamp(14) + random(3) = 20μ
  const random = Math.floor(Math.random() * 1000).toString().padStart(3, '0');
  const sn = `BRO${timestamp}${random}`;
  // 20μ μ΄κ³Ό λ°©μ§€ (μ•μ „μ¥μΉ)
  return sn.length > 20 ? sn.substring(0, 20) : sn;
}
```

**κ²°κ³Ό**: μ •ν™•ν **20μ** μƒμ„±

---

### 2. MESSAGE ν•„λ“ μ•”νΈν™” μ μ©

**μμ •λ μ½”λ“** (`lib/chlifes.ts`):
```typescript
const addPayload = {
  // ... κΈ°νƒ€ ν•„λ“
  MESSAGE: encryptChlifes(request.message || "μƒν’κ¶μ…λ‹λ‹¤"),  // β… μ•”νΈν™” μ μ©
  // ...
};
```

---

## π“ ν…μ¤νΈ κ²°κ³Ό

### β… μ„±κ³µν• ν…μ¤νΈ

```
=== [1/2] ADD API ν…μ¤νΈ (μλΉ„λ°ν–‰) ===
β… μ‘λ‹µ μ½”λ“: 000000 (μ„±κ³µ)
  ISSUE_REQ_SN: BRO176266858984378PH (20μ)
  ISSUE_APRV_SN: 511091509504548C
  μ ν¨κΈ°κ°„: 20251109 ~ 20251209

=== [2/2] SEND API ν…μ¤νΈ (λ°ν–‰ν™•μ •) ===
β… μ‘λ‹µ μ½”λ“: 000000 (μ„±κ³µ)
  BARCODE: 19129705692944
```

### μ „μ²΄ ν”λ΅μ° μ„±κ³µ

- β… ADD API: μ„±κ³µ
- β… SEND API: μ„±κ³µ
- β… λ°”μ½”λ“ μμ‹ : μ„±κ³µ

---

## π“‹ κ·κ²©μ„ μ¤€μ ν™•μΈ

| ν•­λ© | κ·κ²©μ„ μ”κµ¬μ‚¬ν•­ | μμ • μ „ | μμ • ν›„ |
|------|---------------|---------|---------|
| **ISSUE_REQ_SN κΈΈμ΄** | 20μ μ΄ν• | β 23μ | β… 20μ |
| **MESSAGE μ•”νΈν™”** | μ•”νΈν™” ν•„μ | β ν‰λ¬Έ | β… μ•”νΈν™” |
| **FACE_PRICE μ•”νΈν™”** | μ•”νΈν™” ν•„μ | β… μ•”νΈν™” | β… μ•”νΈν™” |
| **RECV_HPNO μ•”νΈν™”** | μ•”νΈν™” ν•„μ | β… μ•”νΈν™” | β… μ•”νΈν™” |
| **ν•„λ“λ… λ€λ¬Έμ** | λ€λ¬Έμ ν•„μ | β… μ¤€μ | β… μ¤€μ |
| **μ—”λ“ν¬μΈνΈ** | /bro/gift_add.php | β… μ¤€μ | β… μ¤€μ |

---

## π”§ μμ •λ νμΌ

1. **`lib/utils.ts`**
   - `generateIssueReqSn()` ν•¨μ μμ •
   - 20μ μ΄ν• λ³΄μ¥ λ΅μ§ μ¶”κ°€

2. **`lib/chlifes.ts`**
   - `addGiftCard()` ν•¨μ μμ •
   - `MESSAGE` ν•„λ“ μ•”νΈν™” μ μ©

---

## β… κ²°λ΅ 

**κ°λ° μ—°λ™μ΄ μ •μƒ μ‘λ™ν•©λ‹λ‹¤!**

κ·κ²©μ„μ— λ…μ‹λ μ”κµ¬μ‚¬ν•­μ„ λ¨λ‘ μ¤€μν•μ—¬:
- β… ISSUE_REQ_SN κΈΈμ΄ μ ν• μ¤€μ (20μ)
- β… MESSAGE ν•„λ“ μ•”νΈν™” μ μ©
- β… ADD β†’ SEND μ „μ²΄ ν”λ΅μ° μ„±κ³µ

---

**λ§μ§€λ§‰ μ—…λ°μ΄νΈ**: 2025-11-09

